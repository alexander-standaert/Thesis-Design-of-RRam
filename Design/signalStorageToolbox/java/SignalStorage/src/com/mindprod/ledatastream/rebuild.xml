<?xml version="1.0"?>
<!-- REBUILD.XML simple ledatastream build that presumes all files are already in the project directory. -->
<!-- Build with ant -f rebuild.xml zip jet -->
<!-- Compile and jar ledatastream using ANT -->
<!-- Invoke with [ant clean] to erase class files and start over. -->
<!-- Invoke with [ant compile] to just compile. -->
<!-- Invoke with [ant javadoc] to generate javadoc. -->
<!-- Invoke with [ant jar] to compile and create jar files. -->
<!-- Invoke with [ant zip] to create source code zip files. -->
<!-- For details of ANT use, see http://mindprod.com/jgloss/ant.html -->

<!-- D E F I N I T I O N S -->
<!-- ANT.project.dir is com/mindprod/ledatastream -->
<!-- basedir is E:/ -->
<project name="ledatastream" basedir="E:/" default="jar">

<!-- extensions for zip. Case sensitive! -->
<property name="distributed.exts" value="**/*.au,**/*.asm,**/*.bat,**/*.btm,**/*.c,**/*.class,**/*.cpp,**/*.css,**/*.csv,**/*.dll,**/*.gif,**/*.h,**/*.hpp,**/*.htm,**/*.html,**/*.ico,**/*.ION,**/*.ion,**/*.jar,**/*.java,**/*.jnlp,**/*.jpg,**/*.look,**/*.png,**/*.properties,**/*.ser,**/*.sln,**/*.txt,**/*.use,**/*.vcproj,**/*.xml" />

<!-- dirs we to exclude from zip. Case sensitive! -->
<property name="nondistributed" value="**/jetpdb/**,**/Debug/**,**/Release/**" />

<!-- C L E A N -->
<target name="clean">
<echo message=":::    ledatastream    ::: deleting files to force regeneration" />
  <delete>
    <fileset dir="com/mindprod/ledatastream" includes="**/*.class" />
    <fileset dir="com/mindprod/ledatastream" includes="**/*.jar" />
    <fileset dir="com/mindprod/ledatastream" includes="ledatastream18.zip" />
  </delete>
</target>

<!-- C O M P I L E -->
<target name="compile">
<echo message=":::    ledatastream    ::: compiling tree." />
  <javac source="1.3" target="1.1" srcdir="com/mindprod/ledatastream" sourcepath="${basedir}" debug="on">
    <compilerarg value="-Xlint:deprecation" />
  </javac>
</target>

<!-- J A V A H -->
<target name="javah" depends="compile">
  <!-- nothing to do -->
</target>

<!-- G A T H E R -->
<target name="gather" depends="compile">
<!-- nothing to do -->
</target>

<!-- J A R -->
<!-- Make apache-ant-1.7.1\lib\GenJar.jar known to ANT -->
<!-- See http://mindprod.com/jgloss/genjar.html for details -->
<taskdef resource="genjar.properties" />

<target name="jar" depends="gather">
 <echo message=":::    ledatastream    ::: genjar finding dependencies and creating jar." />
  <genjar jarfile="com/mindprod/ledatastream/ledatastream.jar">
    <!-- include all classes in the package -->
    <class>
      <fileset dir="${basedir}">
        <!-- include all the classes in com/mindprod/ledatastream -->
        <include name="com/mindprod/ledatastream/*.class" />
        <!-- all dependent classes will be automatically included -->
      </fileset>
    </class>
  </genjar>
</target>

<!-- P O S T J A R -->
<target name="postjar" depends="jar">
  <!-- nothing to do -->
</target>

<!-- J E T  -->
<!-- dummy -->
<target name="jet">
</target>

<!-- P R E J A V A D O C . -->
<target name="prejavadoc">
<echo message=":::    ledatastream    ::: avoid regenerating Javadoc if already done" />
  <uptodate property="javadoc.uptodate" targetfile="com/mindprod/ledatastream/javadoc/index.html">
    <srcfiles dir="com/mindprod/ledatastream" includes="**/*.java" />
  </uptodate>
</target>

<!-- J A V A D O C -->
<target name="javadoc" depends="prejavadoc" unless="javadoc.uptodate">
<echo message=":::    ledatastream    ::: generating Javadoc" />
  <!-- prepare javadoc -->
  <javadoc
    author="true"
    destdir="com/mindprod/ledatastream/javadoc"
    packagenames="com.mindprod.ledatastream.*"
    sourcepath="E:/"
    use="true"
    version="true" />
</target>

<!-- Z I P -->
<target name="zip" depends="javadoc,jar">
<echo message=":::    ledatastream    ::: preparing zip distributable" />
  <!-- Remove references to separate foot files. -->
  <exec executable="prunefoot.exe" failifexecutionfails="false" dir="com/mindprod/ledatastream">
    <arg value="ledatastream.html" />
    <arg value="ledatastream.manual.html" />
  </exec>
  <zip destfile="com/mindprod/ledatastream/ledatastream18.zip" duplicate="preserve" filesonly="true" includes="${distributed.exts}" excludes="${nondistributed}">
    <!-- zipfileset includes all subdirs as well -->
    <zipfileset dir="com/mindprod/ledatastream" prefix="com/mindprod/ledatastream" includes="${distributed.exts}" excludes="${nondistributed}" />
    <zipfileset dir="com/mindprod/common11" prefix="com/mindprod/common11" includes="${distributed.exts}" excludes="${nondistributed}" />
  </zip>
</target>

<!-- P O S T Z I P -->
<target name="postzip" depends="zip,postjar">
  <!-- nothing to do -->
</target>
</project>
